var girder_plugin_homepage=function(e){function t(a){if(o[a])return o[a].exports;var n=o[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var o={};return t.m=e,t.c=o,t.i=function(e){return e},t.d=function(e,o,a){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(4),t(t.s=21)}([function(e,t){e.exports=girder_lib},function(e,t,o){e.exports=o(0)(4)},function(e,t,o){e.exports=o(0)(5)},function(e,t,o){e.exports=o(0)(63)},function(e,t,o){"use strict";o(5),o(7)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var n=o(19),r=a(n),i=o(2),l=a(i),s=o(3),d=o(6),g=a(d);(0,s.exposePluginConfig)("homepage","plugins/homepage/config"),r.default.route("plugins/homepage/config","homepageConfig",function(){l.default.trigger("g:navigateTo",g.default)})},function(e,t,o){"use strict";(function(e){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=o(14),r=a(n),i=o(17),l=a(i),s=o(13),d=a(s),g=o(11),u=a(g),p=o(18),h=a(p),m=o(2),c=a(m),f=o(1),v=o(8),b=a(v);o(9);var x=u.default.extend({events:{"submit #g-homepage-form":function(e){e.preventDefault(),this._saveSettings([{key:"homepage.markdown",value:this.editor.val()},{key:"homepage.header",value:this.$("#g-homepage-header").val()},{key:"homepage.subheader",value:this.$("#g-homepage-subheader").val()},{key:"homepage.welcome_text",value:this.welcomeText.val()},{key:"homepage.logo",value:this.logoFileId}])},"click #g-homepage-logo-reset":function(e){this.logoFileId=null,this._updateLogoDisplay()}},initialize:function(){var t=this,o=(0,f.restRequest)({method:"GET",url:"system/setting",data:{list:JSON.stringify(["homepage.markdown","homepage.header","homepage.subheader","homepage.welcome_text","homepage.logo"])}}).then(function(e){return e}),a=(0,f.restRequest)({method:"GET",url:"homepage/assets"}).then(function(e){return e});e.when(o,a).done(function(e,o){t.editor=new l.default({prefix:"homepage",placeholder:"Enter Markdown for the homepage",parentView:t,parent:new r.default({_id:o["homepage.markdown"]}),enableUploads:!0,maxUploadSize:10485760,allowedExtensions:["png","jpeg","jpg","gif"]}),t.welcomeText=new l.default({prefix:"welcome",placeholder:"Enter Markdown to replace the welcome text.",parentView:t,parent:new r.default({_id:o["homepage.welcome_text"]}),enableUploads:!0,maxUploadSize:10485760,allowedExtensions:["png","jpeg","jpg","gif"]}),t.editor.text=e["homepage.markdown"],t.header=e["homepage.header"],t.subHeader=e["homepage.subheader"],t.welcomeText.text=e["homepage.welcome_text"],t.logoFileId=e["homepage.logo"],t.logoUploader=new h.default({parent:new r.default({_id:o["homepage.logo"]}),parentType:"folder",title:"Homepage Logo",modal:!1,multiFile:!1,parentView:t}),t.listenTo(t.logoUploader,"g:uploadFinished",function(e){t.logoFileId=e.files[0].id,t._updateLogoDisplay()}),t.render()})},_updateLogoDisplay:function(){var e=void 0;e=this.logoFileId?(0,f.getApiRoot)()+"/file/"+this.logoFileId+"/download?contentDisposition=inline":o(16),this.$(".g-homepage-logo-preview img").attr("src",e)},render:function(){return this.$el.html((0,b.default)({header:this.header||null,subHeader:this.subHeader||null,defaultHeader:"Girder",defaultSubHeader:"Data management platform"})),this.editor.setElement(this.$(".g-homepage-container")).render(),this.welcomeText.setElement(this.$(".g-homepage-welcome-text-container")).render(),this.logoUploader.render().$el.appendTo(this.$(".g-homepage-logo-upload-container")),this._updateLogoDisplay(),this.breadcrumb||(this.breadcrumb=new d.default({pluginName:"Homepage",el:this.$(".g-config-breadcrumb-container"),parentView:this}).render()),this},_saveSettings:function(e){var t=this;this.$("#g-homepage-error-message").text(""),(0,f.restRequest)({method:"PUT",url:"system/setting",data:{list:JSON.stringify(e)},error:null}).done(function(){c.default.trigger("g:alert",{icon:"ok",text:"Settings saved.",type:"success",timeout:4e3})}).fail(function(e){t.$("#g-homepage-error-message").text(e.responseJSON.message)})}});t.default=x}).call(t,o(15))},function(e,t,o){"use strict";var a=o(20),n=function(e){return e&&e.__esModule?e:{default:e}}(a),r=o(12),i=o(1);(0,o(3).wrap)(n.default,"render",function(e){var t=this;return(0,i.restRequest)({method:"GET",url:"homepage"}).done(function(o){if(o["homepage.markdown"])t.$el.html((0,r.renderMarkdown)(o["homepage.markdown"]));else if(e.call(t),o["homepage.header"]&&t.$(".g-frontpage-title").text(o["homepage.header"]),o["homepage.subheader"]&&t.$(".g-frontpage-subtitle").text(o["homepage.subheader"]),o["homepage.welcome_text"]&&t.$(".g-frontpage-welcome-text-content").html((0,r.renderMarkdown)(o["homepage.welcome_text"])),o["homepage.logo"]){var a=(0,i.getApiRoot)()+"/file/"+o["homepage.logo"]+"/download?contentDisposition=inline";t.$(".g-frontpage-logo").attr("src",a)}}),this})},function(e,t,o){"use strict";function a(e){var t="",o=e||{};return function(e,o,a,r){t=t+'<div class="g-config-breadcrumb-container"></div><form class="g-settings-form" role="form"><div class="g-settings-form-container"><h4>Instance Branding</h4></div><p class="g-homepage-description"></p>To configure elements of the default homepage<div class="form-group"><label for="g-homepage-header">Header</label><input class="form-control input-sm" id="g-homepage-header" type="text"'+n.attr("value",a||"",!0,!0)+n.attr("placeholder","Default: "+(e||"none"),!0,!0)+' title="The homepage header."></div><div class="form-group"><label for="g-homepage-subheader">Subheader</label><input class="form-control input-sm" id="g-homepage-subheader" type="text"'+n.attr("value",r||"",!0,!0)+n.attr("placeholder","Default: "+(o||"none"),!0,!0)+' title="The homepage subheader."></div><div class="form-group"><label for="g-homepage-welcome-text">Welcome Text</label><div class="g-homepage-welcome-text-container" id="g-homepage-welcome-text"></div></div><div class="form-group"><label>Logo</label><div class="g-homepage-logo-container"><div class="g-homepage-logo-preview-container"><div class="g-homepage-logo-preview"><img alt="Logo"></div><button class="btn btn-sm btn-default" id="g-homepage-logo-reset" type="button" title="Reset default logo">Use default</button></div><div class="g-homepage-logo-upload-container"></div></div></div></form><hr><p class="g-homepage-description">To completely replace the homepage content (ignoring the other settings), enter Markdown here.</p><div class="g-homepage-container"></div><p class="g-validation-failed-message" id="g-homepage-error-message"></p><form id="g-homepage-form" role="form"><input class="btn btn-sm btn-primary" type="submit" value="Save"></form>'}.call(this,"defaultHeader"in o?o.defaultHeader:"undefined"!=typeof defaultHeader?defaultHeader:void 0,"defaultSubHeader"in o?o.defaultSubHeader:"undefined"!=typeof defaultSubHeader?defaultSubHeader:void 0,"header"in o?o.header:"undefined"!=typeof header?header:void 0,"subHeader"in o?o.subHeader:"undefined"!=typeof subHeader?subHeader:void 0),t}var n=o(10);e.exports=a},function(e,t){},function(e,t,o){e.exports=o(0)(0)},function(e,t,o){e.exports=o(0)(1)},function(e,t,o){e.exports=o(0)(10)},function(e,t,o){e.exports=o(0)(135)},function(e,t,o){e.exports=o(0)(19)},function(e,t,o){e.exports=o(0)(2)},function(e,t,o){e.exports=o(0)(250)},function(e,t,o){e.exports=o(0)(36)},function(e,t,o){e.exports=o(0)(37)},function(e,t,o){e.exports=o(0)(7)},function(e,t,o){e.exports=o(0)(72)},function(e,t,o){e.exports=o}]);