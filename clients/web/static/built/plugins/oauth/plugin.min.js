var girder_plugin_oauth=function(e){function t(o){if(i[o])return i[o].exports;var n=i[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var i={};return t.m=e,t.c=i,t.i=function(e){return e},t.d=function(e,i,o){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(9),t(t.s=24)}([function(e,t){e.exports=girder_lib},function(e,t,i){e.exports=i(0)(63)},function(e,t,i){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),r=o(n),a=i(6),s=o(a),l=i(4),d=o(l),u=i(7),c=i(18),p=i(15),h=o(p);i(17);var g=d.default.extend({events:{"click .g-oauth-button":function(e){var t=(0,r.default)(e.currentTarget).attr("g-provider"),i=s.default.findWhere(this.providers,{id:t});window.location=i.url}},initialize:function(e){var t=this,i=e.redirect||(0,c.splitRoute)(window.location.href).base;this.modeText=e.modeText||"log in",this.providers=null,this.enablePasswordLogin=!s.default.has(e,"enablePasswordLogin")||e.enablePasswordLogin,(0,u.restRequest)({url:"oauth/provider",data:{redirect:i,list:!0}}).done(function(e){t.providers=e,t.render()})},render:function(){if(null===this.providers)return this;var e=[];return s.default.each(this.providers,function(t){var i=this._buttons[t.id];i?(i.providerId=t.id,i.text=t.name,e.push(i)):console.warn("Unsupported OAuth2 provider: "+t.id)},this),e.length&&this.$el.append((0,h.default)({modeText:this.modeText,buttons:e,enablePasswordLogin:this.enablePasswordLogin})),this},_buttons:{google:{icon:"gplus",class:"g-oauth-button-google"},globus:{icon:"globe",class:"g-oauth-button-globus"},github:{icon:"github-circled",class:"g-oauth-button-github"},bitbucket:{icon:"bitbucket",class:"g-oauth-button-bitbucket"},linkedin:{icon:"linkedin",class:"g-oauth-button-linkedin"},box:{icon:"box",class:"g-oauth-button-box"}}});t.default=g},function(e,t,i){e.exports=i(0)(0)},function(e,t,i){e.exports=i(0)(1)},function(e,t,i){e.exports=i(0)(2)},function(e,t,i){e.exports=i(0)(3)},function(e,t,i){e.exports=i(0)(4)},function(e,t,i){e.exports=i(0)(5)},function(e,t,i){"use strict";i(10),i(12),i(13)},function(e,t,i){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}var n=i(8),r=o(n),a=i(21),s=o(a),l=i(1),d=i(11),u=o(d);(0,l.exposePluginConfig)("oauth","plugins/oauth/config"),s.default.route("plugins/oauth/config","oauthConfig",function(){r.default.trigger("g:navigateTo",u.default)})},function(e,t,i){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),r=o(n),a=i(6),s=o(a),l=i(19),d=o(l),u=i(4),c=o(u),p=i(7),h=i(8),g=o(h),v=i(14),f=o(v);i(16);var b=c.default.extend({events:{"submit .g-oauth-provider-form":function(e){e.preventDefault();var t=(0,r.default)(e.target).attr("provider-id");this.$("#g-oauth-provider-"+t+"-error-message").empty(),this._saveSettings(t,[{key:"oauth."+t+"_client_id",value:this.$("#g-oauth-provider-"+t+"-client-id").val().trim()},{key:"oauth."+t+"_client_secret",value:this.$("#g-oauth-provider-"+t+"-client-secret").val().trim()}])},"change .g-ignore-registration-policy":function(e){(0,p.restRequest)({method:"PUT",url:"system/setting",data:{key:"oauth.ignore_registration_policy",value:(0,r.default)(e.target).is(":checked")}}).done(function(){g.default.trigger("g:alert",{icon:"ok",text:"Setting saved.",type:"success",timeout:3e3})})}},initialize:function(){this.providers=[{id:"google",name:"Google",icon:"gplus",hasAuthorizedOrigins:!0,instructions:"Client IDs and secret keys are managed in the Google Developer Console. When creating your client ID there, use the following values:"},{id:"globus",name:"Globus",icon:"globe",hasAuthorizedOrigins:!1,instructions:"Client IDs and secret keys are managed in the Google Developer Console. When creating your client ID there, use the following values:"},{id:"github",name:"GitHub",icon:"github-circled",hasAuthorizedOrigins:!1,instructions:"Client IDs and secret keys are managed in the Applications page of your GitHub account settings. Use the following as the authorization callback URL:"},{id:"bitbucket",name:"Bitbucket",icon:"bitbucket",hasAuthorizedOrigins:!1,instructions:"Client IDs and secret keys are managed in the Applications page of your Bitbucket account settings. Use the following as the authorization callback URL:"},{id:"linkedin",name:"LinkedIn",icon:"linkedin",hasAuthorizedOrigins:!1,instructions:'Client IDs and secret keys are managed at the Applications page of the LinkedIn Developers site. Select the "r_basicprofile" and "r_emailaddress" Default Application Permissions, and use the following as an OAuth 2.0 Authorized Redirect URL:'},{id:"box",name:"Box",icon:"box",hasAuthorizedOrigins:!1,instructions:"Client IDs and secret keys are managed in the Box Developer Services page. When creating your client ID there, use the following as the authorization callback URL:"}],this.providerIds=s.default.pluck(this.providers,"id");var e=["oauth.ignore_registration_policy"];s.default.each(this.providerIds,function(t){e.push("oauth."+t+"_client_id"),e.push("oauth."+t+"_client_secret")},this),(0,p.restRequest)({method:"GET",url:"system/setting",data:{list:JSON.stringify(e)}}).done(s.default.bind(function(e){this.settingVals=e,this.render()},this))},render:function(){var e=window.location.protocol+"//"+window.location.host,t=(0,p.getApiRoot)();if("/"!==t.substring(0,1)&&(t="/"+t),this.$el.html((0,f.default)({origin:e,apiRoot:t,providers:this.providers})),this.breadcrumb||(this.breadcrumb=new d.default({pluginName:"OAuth login",el:this.$(".g-config-breadcrumb-container"),parentView:this}).render()),this.settingVals){s.default.each(this.providerIds,function(e){this.$("#g-oauth-provider-"+e+"-client-id").val(this.settingVals["oauth."+e+"_client_id"]),this.$("#g-oauth-provider-"+e+"-client-secret").val(this.settingVals["oauth."+e+"_client_secret"])},this);var i=this.settingVals["oauth.ignore_registration_policy"];this.$(".g-ignore-registration-policy").attr("checked",i?"checked":null)}return this},_saveSettings:function(e,t){t.push({key:"oauth.providers_enabled",value:s.default.filter(this.providerIds,function(e){return!!this.$("#g-oauth-provider-"+e+"-client-id").val()},this)}),(0,p.restRequest)({method:"PUT",url:"system/setting",data:{list:JSON.stringify(t)},error:null}).done(s.default.bind(function(){g.default.trigger("g:alert",{icon:"ok",text:"Settings saved.",type:"success",timeout:3e3})},this)).fail(s.default.bind(function(t){this.$("#g-oauth-provider-"+e+"-error-message").text(t.responseJSON.message)},this))}});t.default=b},function(e,t,i){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}var n=i(22),r=o(n),a=i(1),s=i(2),l=o(s);(0,a.wrap)(r.default,"render",function(e){return e.call(this),new l.default({el:this.$(".modal-body"),parentView:this,enablePasswordLogin:this.enablePasswordLogin}).render(),this})},function(e,t,i){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}var n=i(20),r=o(n),a=i(23),s=i(1),l=i(2),d=o(l);(0,s.wrap)(r.default,"render",function(e){return e.call(this),(0,a.getCurrentUser)()||new d.default({el:this.$(".modal-body"),parentView:this,modeText:"register automatically"}).render(),this})},function(e,t,i){"use strict";function o(e){var t,i="",o=e||{};return function(e,o,r){i+='<div class="g-config-breadcrumb-container"></div><div class="g-reg-policy-config-container"><p>Normally, if the core registration policy is set to closed, OAuth\nusers are also not allowed to be created. If you want to override this\npolicy and allow OAuth users to register even if the core registration\npolicy is closed, check the box below.</p><div class="checkbox"><label><input class="g-ignore-registration-policy" type="checkbox">Ignore closed registration policy</label></div></div><div class="g-oauth-provider-list-title">Configure supported providers below</div><p>Only fill in the information for the OAuth2 providers you wish to enable.</p><div class="panel-group" id="g-oauth-provider-accordion">',function(){var a=r;if("number"==typeof a.length)for(var s=0,l=a.length;s<l;s++){var d=a[s];i=i+'<div class="panel panel-default"><div class="panel-heading" data-toggle="collapse" data-parent="#g-oauth-provider-accordion"'+n.attr("data-target","#g-oauth-provider-"+d.id,!0,!0)+'><div class="panel-title"><a><i'+n.attr("class",n.classes(["icon-"+d.icon],[!0]),!1,!0)+"></i><span>"+n.escape(null==(t=d.name)?"":t)+'</span></a></div></div><div class="panel-collapse collapse"'+n.attr("id","g-oauth-provider-"+d.id,!0,!0)+'><div class="panel-body"><p>'+n.escape(null==(t=d.instructions)?"":t)+"</p>",d.hasAuthorizedOrigins&&(i=i+'<div class="g-oauth-value-container"><b>Authorized javascript origins:</b><span class="g-oauth-value">'+n.escape(null==(t=o)?"":t)+"</span></div>"),i=i+'<div class="g-oauth-value-container"><b>Authorized redirect URI:</b><span class="g-oauth-value">'+n.escape(null==(t=""+o+e+"/oauth/"+d.id+"/callback")?"":t)+'</span></div><form class="g-oauth-provider-form" role="form"'+n.attr("id","g-oauth-provider-"+d.id+"-form",!0,!0)+n.attr("provider-id",d.id,!0,!0)+'><div class="form-group"><label class="control-label"'+n.attr("for","g-oauth-provider-"+d.id+"-client-id",!0,!0)+">"+n.escape(null==(t=d.name)?"":t)+' client ID</label><input class="input-sm form-control"'+n.attr("id","g-oauth-provider-"+d.id+"-client-id",!0,!0)+' type="text" placeholder="Client ID"></div><div class="form-group"><label class="control-label"'+n.attr("for","g-oauth-provider-"+d.id+"-client-secret",!0,!0)+">"+n.escape(null==(t=d.name)?"":t)+' client secret</label><input class="input-sm form-control"'+n.attr("id","g-oauth-provider-"+d.id+"-client-secret",!0,!0)+' type="text" placeholder="Client secret"></div><p class="g-validation-failed-message"'+n.attr("id","g-oauth-provider-"+d.id+"-error-message",!0,!0)+'></p><input class="btn btn-sm btn-primary" type="submit" value="Save"'+n.attr("provider-id",d.id,!0,!0)+"></form></div></div></div>"}else{var l=0;for(var s in a){l++;var d=a[s];i=i+'<div class="panel panel-default"><div class="panel-heading" data-toggle="collapse" data-parent="#g-oauth-provider-accordion"'+n.attr("data-target","#g-oauth-provider-"+d.id,!0,!0)+'><div class="panel-title"><a><i'+n.attr("class",n.classes(["icon-"+d.icon],[!0]),!1,!0)+"></i><span>"+n.escape(null==(t=d.name)?"":t)+'</span></a></div></div><div class="panel-collapse collapse"'+n.attr("id","g-oauth-provider-"+d.id,!0,!0)+'><div class="panel-body"><p>'+n.escape(null==(t=d.instructions)?"":t)+"</p>",d.hasAuthorizedOrigins&&(i=i+'<div class="g-oauth-value-container"><b>Authorized javascript origins:</b><span class="g-oauth-value">'+n.escape(null==(t=o)?"":t)+"</span></div>"),i=i+'<div class="g-oauth-value-container"><b>Authorized redirect URI:</b><span class="g-oauth-value">'+n.escape(null==(t=""+o+e+"/oauth/"+d.id+"/callback")?"":t)+'</span></div><form class="g-oauth-provider-form" role="form"'+n.attr("id","g-oauth-provider-"+d.id+"-form",!0,!0)+n.attr("provider-id",d.id,!0,!0)+'><div class="form-group"><label class="control-label"'+n.attr("for","g-oauth-provider-"+d.id+"-client-id",!0,!0)+">"+n.escape(null==(t=d.name)?"":t)+' client ID</label><input class="input-sm form-control"'+n.attr("id","g-oauth-provider-"+d.id+"-client-id",!0,!0)+' type="text" placeholder="Client ID"></div><div class="form-group"><label class="control-label"'+n.attr("for","g-oauth-provider-"+d.id+"-client-secret",!0,!0)+">"+n.escape(null==(t=d.name)?"":t)+' client secret</label><input class="input-sm form-control"'+n.attr("id","g-oauth-provider-"+d.id+"-client-secret",!0,!0)+' type="text" placeholder="Client secret"></div><p class="g-validation-failed-message"'+n.attr("id","g-oauth-provider-"+d.id+"-error-message",!0,!0)+'></p><input class="btn btn-sm btn-primary" type="submit" value="Save"'+n.attr("provider-id",d.id,!0,!0)+"></form></div></div></div>"}}}.call(this),i+="</div>"}.call(this,"apiRoot"in o?o.apiRoot:"undefined"!=typeof apiRoot?apiRoot:void 0,"origin"in o?o.origin:"undefined"!=typeof origin?origin:void 0,"providers"in o?o.providers:"undefined"!=typeof providers?providers:void 0),i}var n=i(3);e.exports=o},function(e,t,i){"use strict";function o(e){var t,i="",o=e||{};return function(e,o,r){i+='<div class="g-oauth-container"><div class="g-oauth-section-header"><div class="g-oauth-section-header-text">',o?i=i+"Or "+n.escape(null==(t=r)?"":t)+" with":i+="Log in with",i+="</div></div>",function(){var o=e;if("number"==typeof o.length)for(var r=0,a=o.length;r<a;r++){var s=o[r];i=i+"<div"+(n.attr("class",n.classes(["g-oauth-button",s.class],[!1,!0]),!1,!0)+n.attr("g-provider",s.providerId,!0,!0))+'><div class="g-oauth-button-icon"><i'+n.attr("class",n.classes(["icon-"+s.icon],[!0]),!1,!0)+'></i></div><div class="g-oauth-button-text">'+n.escape(null==(t=s.text||s.providerId)?"":t)+"</div></div>"}else{var a=0;for(var r in o){a++;var s=o[r];i=i+"<div"+(n.attr("class",n.classes(["g-oauth-button",s.class],[!1,!0]),!1,!0)+n.attr("g-provider",s.providerId,!0,!0))+'><div class="g-oauth-button-icon"><i'+n.attr("class",n.classes(["icon-"+s.icon],[!0]),!1,!0)+'></i></div><div class="g-oauth-button-text">'+n.escape(null==(t=s.text||s.providerId)?"":t)+"</div></div>"}}}.call(this),i+="</div>"}.call(this,"buttons"in o?o.buttons:"undefined"!=typeof buttons?buttons:void 0,"enablePasswordLogin"in o?o.enablePasswordLogin:"undefined"!=typeof enablePasswordLogin?enablePasswordLogin:void 0,"modeText"in o?o.modeText:"undefined"!=typeof modeText?modeText:void 0),i}var n=i(3);e.exports=o},function(e,t){},function(e,t){},function(e,t,i){e.exports=i(0)(10)},function(e,t,i){e.exports=i(0)(135)},function(e,t,i){e.exports=i(0)(47)},function(e,t,i){e.exports=i(0)(7)},function(e,t,i){e.exports=i(0)(84)},function(e,t,i){e.exports=i(0)(9)},function(e,t,i){e.exports=i}]);