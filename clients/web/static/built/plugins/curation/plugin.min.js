var girder_plugin_curation=function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(6),e(e.s=18)}([function(t,e){t.exports=girder_lib},function(t,e,n){t.exports=n(0)(0)},function(t,e,n){t.exports=n(0)(2)},function(t,e,n){t.exports=n(0)(3)},function(t,e,n){t.exports=n(0)(4)},function(t,e,n){t.exports=n(0)(9)},function(t,e,n){"use strict";n(8)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(2),r=i(o),a=n(3),s=i(a),u=n(14),l=i(u),d=n(12),c=i(d),f=n(16),p=i(f),b=n(5),m=n(4),v=n(9),h=i(v);n(11),n(13);var g=c.default.extend({events:{"click #g-curation-enable":function(t){t.preventDefault(),this._save("Enabled folder curation",{id:this.folder.get("_id"),enabled:!0})},"click #g-curation-disable":function(t){t.preventDefault(),this._save("Disabled folder curation",{id:this.folder.get("_id"),enabled:!1})},"click #g-curation-request":function(t){t.preventDefault(),this._save("Submitted folder for admin approval",{id:this.folder.get("_id"),status:"requested"})},"click #g-curation-approve":function(t){t.preventDefault(),this._save("Approved curated folder",{id:this.folder.get("_id"),status:"approved"})},"click #g-curation-reject":function(t){t.preventDefault(),this._save("Rejected curated folder",{id:this.folder.get("_id"),status:"construction"})},"click #g-curation-reopen":function(t){t.preventDefault(),this._save("Reopened curated folder",{id:this.folder.get("_id"),status:"construction"})}},initialize:function(t){this.folder=this.parentView.parentModel,this.curation={timeline:[]},(0,m.restRequest)({url:"folder/"+this.folder.id+"/curation"}).done(s.default.bind(function(t){this.curation=t,this.render()},this))},render:function(t){var e=this.$el.html((0,h.default)({folder:this.folder,curation:this.curation,moment:l.default}));return t||e.girderModal(this),(0,r.default)(".g-curation-action-container button").hide(),this.curation.enabled?("construction"===this.curation.status&&(0,r.default)("#g-curation-request").show(),(0,b.getCurrentUser)().get("admin")&&((0,r.default)("#g-curation-disable").show(),"requested"===this.curation.status&&((0,r.default)("#g-curation-approve").show(),(0,r.default)("#g-curation-reject").show()),"approved"===this.curation.status&&(0,r.default)("#g-curation-reopen").show())):(0,b.getCurrentUser)().get("admin")&&(0,r.default)("#g-curation-enable").show(),this},_save:function(t,e){(0,m.restRequest)({method:"PUT",url:"folder/"+this.folder.id+"/curation",data:e}).done(s.default.bind(function(e){this.curation=e,this.render(!0),p.default.trigger("g:alert",{icon:"ok",text:t,type:"success",timeout:4e3})},this)).fail(s.default.bind(function(t){this.$("#g-curation-error-message").text(t.responseJSON.message)},this))}});e.default=g},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(){(0,a.default)(".g-folder-actions-menu").append((0,m.default)())}var r=n(2),a=i(r),s=n(3),u=i(s),l=n(15),d=i(l),c=n(5),f=n(4),p=n(17),b=n(10),m=i(b),v=n(7),h=i(v);(0,p.wrap)(d.default,"render",function(t){return t.call(this),"folder"===this.parentModel.get("_modelType")&&((0,c.getCurrentUser)().get("admin")?o():(0,f.restRequest)({url:"folder/"+this.parentModel.id+"/curation"}).done(u.default.bind(function(t){t.enabled&&o()},this))),this}),d.default.prototype.events["click .g-curation-button"]=function(t){new h.default({el:(0,a.default)("#g-dialog-container"),parentView:this,folder:this.parentModel})}},function(t,e,n){"use strict";function i(t){var e,n="",i=t||{};return function(t,i,r){n=n+'<div class="modal-dialog"><div class="modal-content"><form class="modal-form" id="g-curation-form" role="form"><div class="modal-header"><button class="close" data-dismiss="modal" aria-hidden="true" type="button">&times;</button><h4 class="modal-title">Curation details</h4><div class="g-dialog-subtitle"><i class="icon-folder"></i>'+o.escape(null==(e=i.name())?"":e)+'</div></div><div class="modal-body"><div class="g-curation-summary">Curation is<b>'+o.escape(null==(e=t.enabled?"enabled":"disabled")?"":e)+"</b>.",t.enabled&&(n=n+"Curation status is<b>"+o.escape(null==(e=t.status)?"":e)+"</b>."),n=n+"Folder is<b>"+o.escape(null==(e=t.public?"public":"private")?"":e)+"</b>.</div>",t.timeline.length>0&&(n+='<div class="g-curation-timeline-container"><table class="table table-hover table-condensed"><thead><tr><th>User</th><th>Action</th><th>Timestamp</th></tr></thead><tbody>',function(){var i=t.timeline;if("number"==typeof i.length)for(var a=0,s=i.length;a<s;a++){var u=i[a];n=n+"<tr><td>"+o.escape(null==(e=u.userLogin)?"":e)+"</td><td>"+o.escape(null==(e=u.text)?"":e)+"</td>";var l=r.utc(u.timestamp),d=l.local().format("YYYY-MM-DD HH:mm:ss");n=n+"<td"+o.attr("title",d,!0,!0)+">"+o.escape(null==(e=l.fromNow())?"":e)+"</td></tr>"}else{var s=0;for(var a in i){s++;var u=i[a];n=n+"<tr><td>"+o.escape(null==(e=u.userLogin)?"":e)+"</td><td>"+o.escape(null==(e=u.text)?"":e)+"</td>";var l=r.utc(u.timestamp),d=l.local().format("YYYY-MM-DD HH:mm:ss");n=n+"<td"+o.attr("title",d,!0,!0)+">"+o.escape(null==(e=l.fromNow())?"":e)+"</td></tr>"}}}.call(this),n+="</tbody></table></div>"),n+='<div class="g-validation-failed-message" id="g-curation-error-message"></div></div><div class="modal-footer"><div class="g-curation-action-container"><button class="btn btn-small btn-primary" id="g-curation-enable">Enable Curation</button><button class="btn btn-small btn-primary" id="g-curation-request">Request Approval</button><button class="btn btn-small btn-success" id="g-curation-approve">Approve Request</button><button class="btn btn-small btn-danger" id="g-curation-reject">Reject Request</button><button class="btn btn-small btn-default" id="g-curation-reopen">Reopen Folder</button><button class="btn btn-small btn-warning" id="g-curation-disable">Disable Curation</button></div><a class="btn btn-small btn-default" data-dismiss="modal">Close</a></div></form></div></div>'}.call(this,"curation"in i?i.curation:"undefined"!=typeof curation?curation:void 0,"folder"in i?i.folder:"undefined"!=typeof folder?folder:void 0,"moment"in i?i.moment:"undefined"!=typeof moment?moment:void 0),n}var o=n(1);t.exports=i},function(t,e,n){"use strict";function i(t){var e="";return e+='<li class="divider" role="presentation"></li><li role="presentation"><a class="g-curation-button" role="menuitem"><i class="icon-thumbs-up"></i>Folder curation</a></li>'}n(1);t.exports=i},function(t,e){},function(t,e,n){t.exports=n(0)(1)},function(t,e,n){t.exports=n(0)(11)},function(t,e,n){t.exports=n(0)(18)},function(t,e,n){t.exports=n(0)(25)},function(t,e,n){t.exports=n(0)(5)},function(t,e,n){t.exports=n(0)(63)},function(t,e,n){t.exports=n}]);